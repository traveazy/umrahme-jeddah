<!DOCTYPE html>
<html>
<head>
    <title>Umrahme | Jeddah</title>
    <link rel="stylesheet" href="css/holidayMe.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script src="lib/fontA.json" crossorigin="anonymous"></script>
    <script src="lib/topojson.json" crossorigin="anonymous"></script>
    <script src="lib/d3.json" type="text/javascript"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  </head>
<body>
<div id="headerDiv"></div>
<div id="buttonsDiv"></div>
<div id="chartDiv"></div>
<div id="tooltip"></div>
<img id="logoImage" src="flags/logo.png">
<img id="patternImage" src="flags/pattern.png">
<script type="text/javascript" src="js/holidayMeProperties.js"></script>
<script type="text/javascript" src="js/holidayMe.js"></script>
<script type="text/javascript" src="js/holidayMeReusables.js"></script>
<script>

    //document.getElementById("myCheck").click();
    //different index for big screen (no index.html) - exactly the same BUT timeout at the end which loops through buttons and clicks
    //loops through buttons based on number of charts - switches language - loops again and so on.
    //stop/start button at bottom left (very discreet).
    
    //https://observablehq.com/@d3/multitouch
    //https://blocks.roadtolarissa.com/fil/ed3381a662b7619805eb6607d3407b02
    var promises = [
        d3.json("data/world_topo.json"),
        d3.json("data/charts.json"),
        d3.json("data/data_0.json"),
        d3.json("data/data_1.json"),
        d3.json("data/data_2.json"),
        d3.json("data/data_3.json"),
        d3.json("data/data_4.json"),
        d3.json("data/data_5.json"),
        d3.json("data/data_6.json"),
        d3.json("data/data_7.json"),
        d3.csv("data/arabicCountries.csv")
    ]
    Promise.all(promises).then(ready)

    function ready(all_datasets) {

        const language = window.location.search.split("=")[1];

            let buttonGroups = [];
            all_datasets[1].forEach(function(d){
                buttonGroups.push(d.name);
                if(d.id === 0){
                    d.data = all_datasets[2];
                } else if (d.id === 1){
                    d.data = all_datasets[3];
                } else if (d.id === 2){
                    d.data = all_datasets[4];
                } else if (d.id === 3){
                    d.data = all_datasets[5];
                } else if (d.id === 4){
                    d.data = all_datasets[6];
                }  else if (d.id === 5){
                    d.data = all_datasets[7];
                } else if (d.id === 6){
                    d.data = all_datasets[8];
                } else if (d.id === 7){
                    d.data = all_datasets[9];
                } else {
                    d.data = [];
                }
            });


        initialiseDashboard({"arabicCountries":all_datasets[10],"map":all_datasets[0],"charts":all_datasets[1],"currentButtons":buttonGroups,"language":language},"chartDiv","buttonsDiv");

    };


</script>
</body>
</html>
